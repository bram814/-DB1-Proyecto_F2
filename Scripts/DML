
/**  CONSULTA 1
 * Dar el nombre del estudiante, promedio, y número de créditos ganados, para los
 * estudiantes que han cerrado Ingeniería en Ciencias y Sistemas.
*/
SELECT e.nombre as nombre, AVG(a.nota) as promedio, SUM(p.numcreditos) as  creditos FROM asignacion a
    INNER JOIN estudiante e ON e.carnet = a.carnet
    INNER JOIN pensum p ON p.codigo = a.codigo
    INNER JOIN carrera c ON c.carrera = p.carrera
    INNER JOIN curso cu on a.codigo = cu.codigo
WHERE c.carrera = '6' 
group by e.nombre 
HAVING SUM(p.numcreditos) = 141;



SELECT e.nombre as nombre, ca.nombre as carrera, sum(pe.numcreditos)
    FROM Asignacion a
        INNER JOIN estudiante e ON e.carnet = a.carnet
        INNER JOIN seccion se on se.codigo = a.codigo and se.ano = a.ano and se.ciclo = a.ciclo and se.seccion = a.seccion
        INNER JOIN inscrito ins on ins.carnet = a.carnet
        INNER JOIN carrera ca on ca.carrera = ins.carrera
        INNER JOIN plan pl on pl.carrera = ca.carrera
        INNER JOIN Pensum pe on pe.codigo = a.codigo and pe.plan = pl.plan and pe.carrera = ca.carrera
group by e.nombre, ca.nombre
HAVING sum(pe.numcreditos) = 141
order by ca.nombre;